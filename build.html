<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <meta name="keywords" content="build, docker, image" />
  <title>build</title>
  <style type="text/css">code{white-space: pre;}</style>
  <style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
  </style>
</head>
<body>
<div id="header">
<h1 class="title">build</h1>
</div>
<!-- This file is maintained within the docker/docker Github
     repository at https://github.com/docker/docker/. Make all
     pull requests against that repo. If you see this file in
     another repository, consider it read-only there, as it will
     periodically be overwritten by the definitive file. Pull
     requests which include edits to this file in other repositories
     will be rejected.
-->
<h1 id="build">build</h1>
<div class="sourceCode"><pre class="sourceCode markdown"><code class="sourceCode markdown">Usage:  docker build [OPTIONS] PATH | URL | -

Build an image from a Dockerfile

Options:
<span class="bn">      --add-host value          Add a custom host-to-IP mapping (host:ip) (default [])</span>
<span class="bn">      --build-arg value         Set build-time variables (default [])</span>
<span class="bn">      --cache-from value        Images to consider as cache sources (default [])</span>
<span class="bn">      --cgroup-parent string    Optional parent cgroup for the container</span>
<span class="bn">      --compress                Compress the build context using gzip</span>
<span class="bn">      --cpu-period int          Limit the CPU CFS (Completely Fair Scheduler) period</span>
<span class="bn">      --cpu-quota int           Limit the CPU CFS (Completely Fair Scheduler) quota</span>
  -c, --cpu-shares int          CPU shares (relative weight)
<span class="bn">      --cpuset-cpus string      CPUs in which to allow execution (0-3, 0,1)</span>
<span class="bn">      --cpuset-mems string      MEMs in which to allow execution (0-3, 0,1)</span>
<span class="bn">      --disable-content-trust   Skip image verification (default true)</span>
  -f, --file string             Name of the Dockerfile (Default is &#39;PATH/Dockerfile&#39;)
<span class="bn">      --force-rm                Always remove intermediate containers</span>
<span class="bn">      --help                    Print usage</span>
<span class="bn">      --isolation string        Container isolation technology</span>
<span class="bn">      --label value             Set metadata for an image (default [])</span>
  -m, --memory string           Memory limit
<span class="bn">      --memory-swap string      Swap limit equal to memory plus swap: &#39;-1&#39; to enable unlimited swap</span>
<span class="bn">      --network string          Set the networking mode for the RUN instructions during build</span>
<span class="bn">                                &#39;bridge&#39;: use default Docker bridge</span>
<span class="bn">                                &#39;none&#39;: no networking</span>
<span class="bn">                                &#39;container:&lt;name|id&gt;&#39;: reuse another container&#39;s network stack</span>
<span class="bn">                                &#39;host&#39;: use the Docker host network stack</span>
<span class="bn">                                &#39;&lt;network-name&gt;|&lt;network-id&gt;&#39;: connect to a user-defined network</span>
<span class="bn">      --no-cache                Do not use cache when building the image</span>
<span class="bn">      --pull                    Always attempt to pull a newer version of the image</span>
  -q, --quiet                   Suppress the build output and print image ID on success
<span class="bn">      --rm                      Remove intermediate containers after a successful build (default true)</span>
<span class="bn">      --security-opt value      Security Options (default [])</span>
<span class="bn">      --shm-size bytes          Size of /dev/shm</span>
<span class="bn">                                The format is `&lt;number&gt;&lt;unit&gt;`. `number` must be greater than `0`.</span>
<span class="bn">                                Unit is optional and can be `b` (bytes), `k` (kilobytes), `m` (megabytes),</span>
<span class="bn">                                or `g` (gigabytes). If you omit the unit, the system uses bytes.</span>
<span class="bn">      --squash                  Squash newly built layers into a single new layer (**Experimental Only**)</span>
  -t, --tag value               Name and optionally a tag in the &#39;name:tag&#39; format (default [])
<span class="bn">      --ulimit value            Ulimit options (default [])</span></code></pre></div>
<h2 id="description">Description</h2>
<p>Builds Docker images from a Dockerfile and a &quot;context&quot;. A build's context is the files located in the specified <code>PATH</code> or <code>URL</code>. The build process can refer to any of the files in the context. For example, your build can use an <a href="../builder.md#add"><em>ADD</em></a> instruction to reference a file in the context.</p>
<p>The <code>URL</code> parameter can refer to three kinds of resources: Git repositories, pre-packaged tarball contexts and plain text files.</p>
<h3 id="git-repositories">Git repositories</h3>
<p>When the <code>URL</code> parameter points to the location of a Git repository, the repository acts as the build context. The system recursively clones the repository and its submodules using a <code>git clone --depth 1 --recursive</code> command. This command runs in a temporary directory on your local host. After the command succeeds, the directory is sent to the Docker daemon as the context. Local clones give you the ability to access private repositories using local user credentials, VPN's, and so forth.</p>
<p>Git URLs accept context configuration in their fragment section, separated by a colon <code>:</code>. The first part represents the reference that Git will check out, this can be either a branch, a tag, or a commit SHA. The second part represents a subdirectory inside the repository that will be used as a build context.</p>
<p>For example, run this command to use a directory called <code>docker</code> in the branch <code>container</code>:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">docker</span> build https://github.com/docker/rootfs.git#container:docker</code></pre></div>
<p>The following table represents all the valid suffixes with their build contexts:</p>
<table>
<thead>
<tr class="header">
<th align="left">Build Syntax Suffix</th>
<th align="left">Commit Used</th>
<th align="left">Build Context Used</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>myrepo.git</code></td>
<td align="left"><code>refs/heads/master</code></td>
<td align="left"><code>/</code></td>
</tr>
<tr class="even">
<td align="left"><code>myrepo.git#mytag</code></td>
<td align="left"><code>refs/tags/mytag</code></td>
<td align="left"><code>/</code></td>
</tr>
<tr class="odd">
<td align="left"><code>myrepo.git#mybranch</code></td>
<td align="left"><code>refs/heads/mybranch</code></td>
<td align="left"><code>/</code></td>
</tr>
<tr class="even">
<td align="left"><code>myrepo.git#abcdef</code></td>
<td align="left"><code>sha1 = abcdef</code></td>
<td align="left"><code>/</code></td>
</tr>
<tr class="odd">
<td align="left"><code>myrepo.git#:myfolder</code></td>
<td align="left"><code>refs/heads/master</code></td>
<td align="left"><code>/myfolder</code></td>
</tr>
<tr class="even">
<td align="left"><code>myrepo.git#master:myfolder</code></td>
<td align="left"><code>refs/heads/master</code></td>
<td align="left"><code>/myfolder</code></td>
</tr>
<tr class="odd">
<td align="left"><code>myrepo.git#mytag:myfolder</code></td>
<td align="left"><code>refs/tags/mytag</code></td>
<td align="left"><code>/myfolder</code></td>
</tr>
<tr class="even">
<td align="left"><code>myrepo.git#mybranch:myfolder</code></td>
<td align="left"><code>refs/heads/mybranch</code></td>
<td align="left"><code>/myfolder</code></td>
</tr>
<tr class="odd">
<td align="left"><code>myrepo.git#abcdef:myfolder</code></td>
<td align="left"><code>sha1 = abcdef</code></td>
<td align="left"><code>/myfolder</code></td>
</tr>
</tbody>
</table>
<h3 id="tarball-contexts">Tarball contexts</h3>
<p>If you pass an URL to a remote tarball, the URL itself is sent to the daemon:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">docker</span> build http://server/context.tar.gz</code></pre></div>
<p>The download operation will be performed on the host the Docker daemon is running on, which is not necessarily the same host from which the build command is being issued. The Docker daemon will fetch <code>context.tar.gz</code> and use it as the build context. Tarball contexts must be tar archives conforming to the standard <code>tar</code> UNIX format and can be compressed with any one of the 'xz', 'bzip2', 'gzip' or 'identity' (no compression) formats.</p>
<h3 id="text-files">Text files</h3>
<p>Instead of specifying a context, you can pass a single <code>Dockerfile</code> in the <code>URL</code> or pipe the file in via <code>STDIN</code>. To pipe a <code>Dockerfile</code> from <code>STDIN</code>:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">docker</span> build - <span class="kw">&lt;</span> Dockerfile</code></pre></div>
<p>With Powershell on Windows, you can run:</p>
<pre class="powershell"><code>Get-Content Dockerfile | docker build -</code></pre>
<p>If you use <code>STDIN</code> or specify a <code>URL</code> pointing to a plain text file, the system places the contents into a file called <code>Dockerfile</code>, and any <code>-f</code>, <code>--file</code> option is ignored. In this scenario, there is no context.</p>
<p>By default the <code>docker build</code> command will look for a <code>Dockerfile</code> at the root of the build context. The <code>-f</code>, <code>--file</code>, option lets you specify the path to an alternative file to use instead. This is useful in cases where the same set of files are used for multiple builds. The path must be to a file within the build context. If a relative path is specified then it is interpreted as relative to the root of the context.</p>
<p>In most cases, it's best to put each Dockerfile in an empty directory. Then, add to that directory only the files needed for building the Dockerfile. To increase the build's performance, you can exclude files and directories by adding a <code>.dockerignore</code> file to that directory as well. For information on creating one, see the <a href="../builder.md#dockerignore-file">.dockerignore file</a>.</p>
<p>If the Docker client loses connection to the daemon, the build is canceled. This happens if you interrupt the Docker client with <code>CTRL-c</code> or if the Docker client is killed for any reason. If the build initiated a pull which is still running at the time the build is cancelled, the pull is cancelled as well.</p>
<h2 id="return-code">Return code</h2>
<p>On a successful build, a return code of success <code>0</code> will be returned. When the build fails, a non-zero failure code will be returned.</p>
<p>There should be informational output of the reason for failure output to <code>STDERR</code>:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">docker</span> build -t fail .

<span class="kw">Sending</span> build context to Docker daemon 2.048 kB
<span class="kw">Sending</span> build context to Docker daemon
<span class="kw">Step</span> 1/3 : FROM busybox
 <span class="kw">---&gt;</span> 4986bf8c1536
<span class="kw">Step</span> 2/3 : RUN exit 13
 <span class="kw">---&gt;</span> Running in e26670ec7a0a
<span class="kw">INFO</span>[0000] The command [/bin/sh -c exit 13] returned a non-zero code: 13
$ <span class="kw">echo</span> <span class="ot">$?</span>
<span class="kw">1</span></code></pre></div>
<p>See also:</p>
<p><a href="../builder.md"><em>Dockerfile Reference</em></a>.</p>
<h2 id="examples">Examples</h2>
<h3 id="build-with-path">Build with PATH</h3>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">docker</span> build .

<span class="kw">Uploading</span> context 10240 bytes
<span class="kw">Step</span> 1/3 : FROM busybox
<span class="kw">Pulling</span> repository busybox
 <span class="kw">---&gt;</span> e9aa60c60128MB/2.284 MB (100%) <span class="kw">endpoint</span>: https://cdn-registry-1.docker.io/v1/
<span class="kw">Step</span> 2/3 : RUN ls -lh /
 <span class="kw">---&gt;</span> Running in 9c9e81692ae9
<span class="kw">total</span> 24
<span class="kw">drwxr-xr-x</span>    2 root     root        4.0K Mar 12  2013 bin
<span class="kw">drwxr-xr-x</span>    5 root     root        4.0K Oct 19 00:19 dev
<span class="kw">drwxr-xr-x</span>    2 root     root        4.0K Oct 19 00:19 etc
<span class="kw">drwxr-xr-x</span>    2 root     root        4.0K Nov 15 23:34 lib
<span class="kw">lrwxrwxrwx</span>    1 root     root           3 Mar 12  2013 lib64 -<span class="kw">&gt;</span> lib
<span class="kw">dr-xr-xr-x</span>  116 root     root           0 Nov 15 23:34 proc
<span class="kw">lrwxrwxrwx</span>    1 root     root           3 Mar 12  2013 sbin -<span class="kw">&gt;</span> bin
<span class="kw">dr-xr-xr-x</span>   13 root     root           0 Nov 15 23:34 sys
<span class="kw">drwxr-xr-x</span>    2 root     root        4.0K Mar 12  2013 tmp
<span class="kw">drwxr-xr-x</span>    2 root     root        4.0K Nov 15 23:34 usr
 <span class="kw">---&gt;</span> b35f4035db3f
<span class="kw">Step</span> 3/3 : CMD echo Hello world
 <span class="kw">---&gt;</span> Running in 02071fceb21b
 <span class="kw">---&gt;</span> f52f38b7823e
<span class="kw">Successfully</span> built f52f38b7823e
<span class="kw">Removing</span> intermediate container 9c9e81692ae9
<span class="kw">Removing</span> intermediate container 02071fceb21b</code></pre></div>
<p>This example specifies that the <code>PATH</code> is <code>.</code>, and so all the files in the local directory get <code>tar</code>d and sent to the Docker daemon. The <code>PATH</code> specifies where to find the files for the &quot;context&quot; of the build on the Docker daemon. Remember that the daemon could be running on a remote machine and that no parsing of the Dockerfile happens at the client side (where you're running <code>docker build</code>). That means that <em>all</em> the files at <code>PATH</code> get sent, not just the ones listed to <a href="../builder.md#add"><em>ADD</em></a> in the Dockerfile.</p>
<p>The transfer of context from the local machine to the Docker daemon is what the <code>docker</code> client means when you see the &quot;Sending build context&quot; message.</p>
<p>If you wish to keep the intermediate containers after the build is complete, you must use <code>--rm=false</code>. This does not affect the build cache.</p>
<h3 id="build-with-url">Build with URL</h3>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">docker</span> build github.com/creack/docker-firefox</code></pre></div>
<p>This will clone the GitHub repository and use the cloned repository as context. The Dockerfile at the root of the repository is used as Dockerfile. You can specify an arbitrary Git repository by using the <code>git://</code> or <code>git@</code> scheme.</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">docker</span> build -f ctx/Dockerfile http://server/ctx.tar.gz

<span class="kw">Downloading</span> context: http://server/ctx.tar.gz [===================<span class="kw">&gt;</span>]    240 B/240 B
<span class="kw">Step</span> 1/3 : FROM busybox
 <span class="kw">---&gt;</span> 8c2e06607696
<span class="kw">Step</span> 2/3 : ADD ctx/container.cfg /
 <span class="kw">---&gt;</span> e7829950cee3
<span class="kw">Removing</span> intermediate container b35224abf821
<span class="kw">Step</span> 3/3 : CMD /bin/ls
 <span class="kw">---&gt;</span> Running in fbc63d321d73
 <span class="kw">---&gt;</span> 3286931702ad
<span class="kw">Removing</span> intermediate container fbc63d321d73
<span class="kw">Successfully</span> built 377c409b35e4</code></pre></div>
<p>This sends the URL <code>http://server/ctx.tar.gz</code> to the Docker daemon, which downloads and extracts the referenced tarball. The <code>-f ctx/Dockerfile</code> parameter specifies a path inside <code>ctx.tar.gz</code> to the <code>Dockerfile</code> that is used to build the image. Any <code>ADD</code> commands in that <code>Dockerfile</code> that refers to local paths must be relative to the root of the contents inside <code>ctx.tar.gz</code>. In the example above, the tarball contains a directory <code>ctx/</code>, so the <code>ADD ctx/container.cfg /</code> operation works as expected.</p>
<h3 id="build-with--">Build with -</h3>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">docker</span> build - <span class="kw">&lt;</span> Dockerfile</code></pre></div>
<p>This will read a Dockerfile from <code>STDIN</code> without context. Due to the lack of a context, no contents of any local directory will be sent to the Docker daemon. Since there is no context, a Dockerfile <code>ADD</code> only works if it refers to a remote URL.</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">docker</span> build - <span class="kw">&lt;</span> context.tar.gz</code></pre></div>
<p>This will build an image for a compressed context read from <code>STDIN</code>. Supported formats are: bzip2, gzip and xz.</p>
<h3 id="use-a-.dockerignore-file">Use a .dockerignore file</h3>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">docker</span> build .

<span class="kw">Uploading</span> context 18.829 MB
<span class="kw">Uploading</span> context
<span class="kw">Step</span> 1/2 : FROM busybox
 <span class="kw">---&gt;</span> 769b9341d937
<span class="kw">Step</span> 2/2 : CMD echo Hello world
 <span class="kw">---&gt;</span> Using cache
 <span class="kw">---&gt;</span> 99cc1ad10469
<span class="kw">Successfully</span> built 99cc1ad10469
$ <span class="kw">echo</span> <span class="st">&quot;.git&quot;</span> <span class="kw">&gt;</span> .dockerignore
$ <span class="kw">docker</span> build .
<span class="kw">Uploading</span> context  6.76 MB
<span class="kw">Uploading</span> context
<span class="kw">Step</span> 1/2 : FROM busybox
 <span class="kw">---&gt;</span> 769b9341d937
<span class="kw">Step</span> 2/2 : CMD echo Hello world
 <span class="kw">---&gt;</span> Using cache
 <span class="kw">---&gt;</span> 99cc1ad10469
<span class="kw">Successfully</span> built 99cc1ad10469</code></pre></div>
<p>This example shows the use of the <code>.dockerignore</code> file to exclude the <code>.git</code> directory from the context. Its effect can be seen in the changed size of the uploaded context. The builder reference contains detailed information on <a href="../builder.md#dockerignore-file">creating a .dockerignore file</a></p>
<h3 id="tag-an-image--t">Tag an image (-t)</h3>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">docker</span> build -t vieux/apache:2.0 .</code></pre></div>
<p>This will build like the previous example, but it will then tag the resulting image. The repository name will be <code>vieux/apache</code> and the tag will be <code>2.0</code>. <a href="tag.md">Read more about valid tags</a>.</p>
<p>You can apply multiple tags to an image. For example, you can apply the <code>latest</code> tag to a newly built image and add another tag that references a specific version. For example, to tag an image both as <code>whenry/fedora-jboss:latest</code> and <code>whenry/fedora-jboss:v2.1</code>, use the following:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">docker</span> build -t whenry/fedora-jboss:latest -t whenry/fedora-jboss:v2.1 .</code></pre></div>
<h3 id="specify-a-dockerfile--f">Specify a Dockerfile (-f)</h3>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">docker</span> build -f Dockerfile.debug .</code></pre></div>
<p>This will use a file called <code>Dockerfile.debug</code> for the build instructions instead of <code>Dockerfile</code>.</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">docker</span> build -f dockerfiles/Dockerfile.debug -t myapp_debug .
$ <span class="kw">docker</span> build -f dockerfiles/Dockerfile.prod  -t myapp_prod .</code></pre></div>
<p>The above commands will build the current build context (as specified by the <code>.</code>) twice, once using a debug version of a <code>Dockerfile</code> and once using a production version.</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">cd</span> /home/me/myapp/some/dir/really/deep
$ <span class="kw">docker</span> build -f /home/me/myapp/dockerfiles/debug /home/me/myapp
$ <span class="kw">docker</span> build -f ../../../../dockerfiles/debug /home/me/myapp</code></pre></div>
<p>These two <code>docker build</code> commands do the exact same thing. They both use the contents of the <code>debug</code> file instead of looking for a <code>Dockerfile</code> and will use <code>/home/me/myapp</code> as the root of the build context. Note that <code>debug</code> is in the directory structure of the build context, regardless of how you refer to it on the command line.</p>
<blockquote>
<p><strong>Note:</strong> <code>docker build</code> will return a <code>no such file or directory</code> error if the file or directory does not exist in the uploaded context. This may happen if there is no context, or if you specify a file that is elsewhere on the Host system. The context is limited to the current directory (and its children) for security reasons, and to ensure repeatable builds on remote Docker hosts. This is also the reason why <code>ADD ../file</code> will not work.</p>
</blockquote>
<h3 id="use-a-custom-parent-cgroup---cgroup-parent">Use a custom parent cgroup (--cgroup-parent)</h3>
<p>When <code>docker build</code> is run with the <code>--cgroup-parent</code> option the containers used in the build will be run with the <a href="../run.md#specifying-custom-cgroups">corresponding <code>docker run</code> flag</a>.</p>
<h3 id="set-ulimits-in-container---ulimit">Set ulimits in container (--ulimit)</h3>
<p>Using the <code>--ulimit</code> option with <code>docker build</code> will cause each build step's container to be started using those <a href="./run.md#set-ulimits-in-container-ulimit"><code>--ulimit</code> flag values</a>.</p>
<h3 id="set-build-time-variables---build-arg">Set build-time variables (--build-arg)</h3>
<p>You can use <code>ENV</code> instructions in a Dockerfile to define variable values. These values persist in the built image. However, often persistence is not what you want. Users want to specify variables differently depending on which host they build an image on.</p>
<p>A good example is <code>http_proxy</code> or source versions for pulling intermediate files. The <code>ARG</code> instruction lets Dockerfile authors define values that users can set at build-time using the <code>--build-arg</code> flag:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">docker</span> build --build-arg HTTP_PROXY=http://10.20.30.2:1234 .</code></pre></div>
<p>This flag allows you to pass the build-time variables that are accessed like regular environment variables in the <code>RUN</code> instruction of the Dockerfile. Also, these values don't persist in the intermediate or final images like <code>ENV</code> values do.</p>
<p>Using this flag will not alter the output you see when the <code>ARG</code> lines from the Dockerfile are echoed during the build process.</p>
<p>For detailed information on using <code>ARG</code> and <code>ENV</code> instructions, see the <a href="../builder.md">Dockerfile reference</a>.</p>
<h3 id="optional-security-options---security-opt">Optional security options (--security-opt)</h3>
<p>This flag is only supported on a daemon running on Windows, and only supports the <code>credentialspec</code> option. The <code>credentialspec</code> must be in the format <code>file://spec.txt</code> or <code>registry://keyname</code>.</p>
<h3 id="specify-isolation-technology-for-container---isolation">Specify isolation technology for container (--isolation)</h3>
<p>This option is useful in situations where you are running Docker containers on Windows. The <code>--isolation=&lt;value&gt;</code> option sets a container's isolation technology. On Linux, the only supported is the <code>default</code> option which uses Linux namespaces. On Microsoft Windows, you can specify these values:</p>
<table>
<colgroup>
<col width="6%" />
<col width="93%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Value</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>default</code></td>
<td align="left">Use the value specified by the Docker daemon's <code>--exec-opt</code> . If the <code>daemon</code> does not specify an isolation technology, Microsoft Windows uses <code>process</code> as its default value.</td>
</tr>
<tr class="even">
<td align="left"><code>process</code></td>
<td align="left">Namespace isolation only.</td>
</tr>
<tr class="odd">
<td align="left"><code>hyperv</code></td>
<td align="left">Hyper-V hypervisor partition-based isolation.</td>
</tr>
</tbody>
</table>
<p>Specifying the <code>--isolation</code> flag without a value is the same as setting <code>--isolation=&quot;default&quot;</code>.</p>
<h3 id="add-entries-to-container-hosts-file---add-host">Add entries to container hosts file (--add-host)</h3>
<p>You can add other hosts into a container's <code>/etc/hosts</code> file by using one or more <code>--add-host</code> flags. This example adds a static address for a host named <code>docker</code>:</p>
<pre><code>$ docker build --add-host=docker:10.180.0.1 .</code></pre>
<h3 id="squash-an-images-layers---squash-experimental-only">Squash an image's layers (--squash) <strong>Experimental Only</strong></h3>
<p>Once the image is built, squash the new layers into a new image with a single new layer. Squashing does not destroy any existing image, rather it creates a new image with the content of the squashed layers. This effectively makes it look like all <code>Dockerfile</code> commands were created with a single layer. The build cache is preserved with this method.</p>
<p><strong>Note</strong>: using this option means the new image will not be able to take advantage of layer sharing with other images and may use significantly more space.</p>
<p><strong>Note</strong>: using this option you may see significantly more space used due to storing two copies of the image, one for the build cache with all the cache layers in tact, and one for the squashed version.</p>
</body>
</html>
